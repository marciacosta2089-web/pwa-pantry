<!doctype html>
<html lang="pt">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Despensa & Refeições</title>
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0ea5e9">
  <style>
    :root{--bg:#0b1220;--card:#0f172a;--muted:#94a3b8;--text:#e2e8f0;--accent:#0ea5e9;--ok:#22c55e;--warn:#f59e0b;--bad:#ef4444}
    *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif;background:var(--bg);color:var(--text)}
    header{position:sticky;top:0;background:rgba(11,18,32,.8);backdrop-filter:blur(8px);z-index:10;border-bottom:1px solid #1e293b}
    header .wrap{max-width:980px;margin:auto;padding:12px 16px;display:flex;gap:12px;align-items:center;justify-content:space-between}
    .brand{display:flex;gap:10px;align-items:center} .brand .logo{width:28px;height:28px;border-radius:8px;background:#0ea5e9;display:grid;place-items:center;color:white;font-weight:700}
    .tabs{display:flex;gap:10px;flex-wrap:wrap} .tab{padding:8px 12px;border:1px solid #1e293b;border-radius:10px;cursor:pointer}
    .tab.active{background:var(--accent);color:#00111a;border-color:transparent}
    main{max-width:980px;margin:10px auto;padding:16px;display:grid;gap:16px}
    .card{background:var(--card);border:1px solid #1e293b;border-radius:16px;padding:14px}
    h2{margin:0 0 10px 0;font-size:18px}
    input,select,button,textarea{border-radius:10px;border:1px solid #1e293b;background:#0b1220;color:var(--text);padding:10px}
    button{cursor:pointer}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px}
    .pill{display:inline-block;padding:4px 8px;border-radius:999px;background:#0b1220;border:1px solid #1e293b;color:var(--muted);font-size:12px}
    .muted{color:var(--muted)}
    .ok{color:var(--ok)} .bad{color:var(--bad)} .warn{color:var(--warn)}
    .list{display:grid;gap:8px}
    .item{display:flex;justify-content:space-between;align-items:center;border:1px solid #1e293b;border-radius:12px;padding:10px;background:#0b1220}
    .item .left{display:flex;gap:10px;align-items:center}
    .item .name{font-weight:600}
    .actions{display:flex;gap:6px}
    .footer{display:flex;gap:8px;flex-wrap:wrap}
    .k{font-variant-numeric:tabular-nums}
    @media (hover:hover){ .item:hover{border-color:#334155} }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="brand"><div class="logo">MP</div><div>
        <div style="font-weight:700">Despensa & Refeições</div>
        <div class="muted" style="font-size:12px">PWA local — funciona offline e no telemóvel</div>
      </div></div>
      <nav class="tabs">
        <button id="install-btn" class="tab" style="display:none">Instalar app</button>
        <div class="tab active" data-tab="despensa">Despensa</div>
        <div class="tab" data-tab="receitas">Receitas</div>
        <div class="tab" data-tab="sugestoes">Sugestões</div>
        <div class="tab" data-tab="compras">Lista de Compras</div>
        <div class="tab" data-tab="dados">Dados</div>
      </nav>
    </div>
  </header>

  <main>
    <section id="despensa" class="card">
      <h2>Despensa</h2>
      <div class="row">
        <input id="p-name" placeholder="Item (ex.: arroz)">
        <input id="p-qtd" type="number" placeholder="Quantidade" style="width:120px">
        <input id="p-unit" placeholder="Unidade (g, un, ml…)" style="width:120px">
        <button id="p-add">Adicionar</button>
      </div>
      <div style="height:8px"></div>
      <div id="pantry-list" class="list"></div>
    </section>

    <section id="receitas" class="card" style="display:none">
      <h2>Receitas</h2>
      <div class="row">
        <input id="r-name" placeholder="Nome da receita">
        <input id="r-time" type="number" placeholder="Minutos" style="width:120px">
        <input id="r-tags" placeholder="Tags (ex.: vegetariano, sem_lactose)" style="min-width:260px">
      </div>
      <div class="row" style="margin-top:8px">
        <input id="r-ing-name" placeholder="Ingrediente (ex.: tomate)">
        <input id="r-ing-qtd" type="number" placeholder="Qtd" style="width:120px">
        <button id="r-add-ing">+ Ingrediente</button>
        <button id="r-save">Guardar receita</button>
      </div>
      <div id="r-ings" class="list" style="margin-top:8px"></div>
      <hr style="border:0;border-top:1px solid #1e293b;margin:16px 0">
      <div id="recipes-list" class="grid"></div>
    </section>

    <section id="sugestoes" class="card" style="display:none">
      <h2>Sugestões com o que tens</h2>
      <div class="muted" style="margin-bottom:8px">Mostra receitas “fazíveis agora” e as que estão quase (apenas poucos itens em falta).</div>
      <div id="suggestions" class="grid"></div>
    </section>

    <section id="compras" class="card" style="display:none">
      <h2>Lista de Compras</h2>
      <div class="muted" style="margin-bottom:8px">Seleciona receitas para o teu plano; agregamos os itens em falta.</div>
      <div id="plan-select" class="grid"></div>
      <div style="height:8px"></div>
      <div id="shopping-list" class="list"></div>
    </section>

    <section id="dados" class="card" style="display:none">
      <h2>Dados (Exportar/Importar)</h2>
      <div class="row">
        <button id="export">Exportar JSON</button>
        <input type="file" id="import" accept="application/json">
      </div>
      <div class="footer muted" style="margin-top:8px">
        <span class="pill">Local-first</span>
        <span class="pill">Offline</span>
        <span class="pill">Instalável</span>
      </div>
      <div style="margin-top:8px" class="muted">Dica: hospeda esta pasta no GitHub Pages/Netlify para instalar no telemóvel. Os dados ficam no teu dispositivo; podes sincronizar manualmente via export/import.</div>
    </section>
  </main>

  <script src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => navigator.serviceWorker.register('./sw.js'));
    }
  </script>
</body>
</html>
